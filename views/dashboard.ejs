<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Afaa' Snack</title>
    <link rel="icon" type="image/jpeg" href="/images/logo.jpeg">
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo-dash">
                    <img src="/images/logo.jpeg" alt="Afaa' Snack" class="sidebar-logo">
                </div>
            </div>
            
            <div class="user-info">
                <p>Halo, <strong><%= user.nama %></strong></p>
            </div>

            <nav class="sidebar-nav">
                <a href="/dashboard" class="nav-item active">
                    <span class="icon">ðŸ“Š</span>
                    <span>Dashboard</span>
                </a>
                <a href="/kasir" class="nav-item">
                    <span class="icon">ðŸ’°</span>
                    <span>Kasir</span>
                </a>
                <a href="/stok" class="nav-item">
                    <span class="icon">ðŸ“¦</span>
                    <span>Inventory</span>
                </a>
                <a href="/laporan" class="nav-item">
                    <span class="icon">ðŸ“„</span>
                    <span>Laporan Penjualan</span>
                </a>
                <a href="/logout" class="nav-item logout">
                    <span class="icon">ðŸšª</span>
                    <span>Logout</span>
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="content-header">
                <h1>Dashboard</h1>
            </header>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card card-blue">
                    <div class="stat-icon">ðŸ’³</div>
                    <div class="stat-info">
                        <h3><%= stats.transaksiHariIni %></h3>
                        <p>TRANSAKSI HARI INI</p>
                    </div>
                </div>

                <div class="stat-card card-green">
                    <div class="stat-icon">ðŸ’µ</div>
                    <div class="stat-info">
                        <h3>Rp <%= stats.penjualanHariIni.toLocaleString('id-ID') %></h3>
                        <p>PENJUALAN HARI INI</p>
                    </div>
                </div>

                <div class="stat-card card-orange">
                    <div class="stat-icon">ðŸ“¦</div>
                    <div class="stat-info">
                        <h3><%= stats.totalStok %></h3>
                        <p>TOTAL STOK SNACK</p>
                    </div>
                </div>
            </div>

            <!-- Transaksi Terbaru -->
            <div class="content-section">
                <h2 class="section-title">Transaksi Terbaru</h2>
                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>No</th>
                                <th>Tanggal</th>
                                <th>Waktu</th>
                                <th>Kasir</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% if (transaksiTerbaru.length === 0) { %>
                                <tr>
                                    <td colspan="5" class="text-center">Belum ada transaksi</td>
                                </tr>
                            <% } else { %>
                                <% transaksiTerbaru.forEach(t => { %>
                                    <tr>
                                        <td><%= t.no %></td>
                                        <td><%= new Date(t.tanggal).toLocaleDateString('id-ID') %></td>
                                        <td class="current-time" data-waktu="<%= t.waktu %>"><%= t.waktu %></td>
                                        <td><%= t.nama_user %></td>
                                        <td>Rp <%= t.total_harga.toLocaleString('id-ID') %></td>
                                    </tr>
                                <% }) %>
                            <% } %>
                        </tbody>
                    </table>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Fungsi untuk update waktu real-time
        function updateCurrentTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('id-ID', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: false 
            });
            
            // Update semua cell dengan class 'current-time' dengan waktu saat ini
            document.querySelectorAll('.current-time').forEach(cell => {
                cell.textContent = timeString;
            });
        }

        // Update waktu setiap detik
        setInterval(updateCurrentTime, 1000);
        
        // Update waktu saat halaman pertama kali dimuat
        updateCurrentTime();

        // Auto refresh setiap 30 detik untuk update data terbaru
        setInterval(() => {
            location.reload();
        }, 30000);
    </script>
</body>
</html>
